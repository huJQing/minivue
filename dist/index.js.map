{"version":3,"file":"index.js","sources":["../src/observe/array.js","../src/observe/dep.js","../src/observe/index.js","../src/state.js","../src/compiler/parse.js","../src/compiler/codegen.js","../src/compiler/index.js","../src/vdom/patch.js","../src/observe/watcher.js","../src/vdom/index.js","../src/index.js","../src/init.js","../src/lifecycle.js","../src/render.js"],"sourcesContent":["// 保留数组原型\nconst arrayProto = Array.prototype\n\n// 然后将arrayMethods继承自数组原型\nexport const arrayMethods = Object.create(arrayProto)\nlet methodsToPatch = [\n    \"push\",\n    \"pop\",\n    \"shift\",\n    \"unshift\",\n    \"splice\",\n    \"reverse\",\n    \"sort\",\n];\n\nmethodsToPatch.forEach((method) => {\n    arrayMethods[method] = function (...args) {\n        // 保留原型方法的执行结果\n        const result = arrayProto[method].call(this, args)\n\n        /*\n        * this代表的就是数据本身 比如数据是{a:[1,2,3]} \n        * 那么我们使用a.push(4)  \n        * this就是a  \n        * ob就是a.__ob__ 这个属性就是上段代码增加的 \n        * 代表的是该数据已经被响应式观察过了指向Observer实例\n        **/\n        const ob = this.__ob__\n\n\n        // 这里的标志就是代表数组有新增操作，新增的可能是对象\n        let inserted;\n        switch (method) {\n            case \"push\":\n            case \"unshift\":\n                inserted = args;\n                break;\n            case \"splice\":\n                inserted = args.slice(2);\n            default:\n                break;\n        }\n        // 如果有新增的元素 inserted是一个数组 调用Observer实例的observeArray对数组每一项进行观测\n        if (inserted) ob.observeArray(inserted);\n        // 之后咱们还可以在这里检测到数组改变了之后从而触发视图更新的操作\n        return result;\n    }\n})","let id = 0\nexport default class Dep {\n    constructor() {\n        this.id = id++\n        this.subs = []\n    }\n    depend() {\n        if (Dep.target) {\n            Dep.target.addDep(this)\n        }\n    }\n    notify() {\n        this.subs.forEach((watcher) => watcher.update())\n    }\n    addSub(watcher) {\n        this.subs.push(watcher)\n    }\n}\n\nDep.target = null\nconst targetStack = []\n\nexport function pushTarget(watcher) {\n    targetStack.push(watcher)\n    Dep.target = watcher\n}\n\nexport function popTarget() {\n    targetStack.pop()\n    Dep.target = targetStack[targetStack.length - 1]\n}","import { arrayMethods } from \"./array\";\nimport Dep from \"./dep\";\nclass Observe {\n    constructor(value) {\n        // 给Observe实例加上__ob__以方便数组观测时新增了元素后调用observeArray添加响应式观测\n        Object.defineProperty(value, \"__ob__\", {\n            //  值指代的就是Observer的实例\n            value: this,\n            //  不可枚举\n            enumerable: false,\n            writable: true,\n            configurable: true,\n        });\n        if (Array.isArray(value)) {\n            value.__proto__ = arrayMethods\n            this.observeArray(value)\n        } else {\n            this.walk(value)\n        }\n    }\n\n    walk(data) {\n        Object.keys(data).forEach(key => {\n            let value = data[key]\n            defineReactive(data, key, value)\n        })\n    }\n\n\n    observeArray(items) {\n        for (let i = 0; i < items.length; i++) {\n            observe(items[i]);\n        }\n    }\n}\n\nfunction defineReactive(data, key, value) {\n    observe(value)\n    // 为每个属性实例化一个Dep\n    let dep = new Dep()\n    Object.defineProperty(data, key, {\n        get() {\n            // 页面取值的时候 可以把watcher收集到dep里面--依赖收集\n            if (Dep.target) {\n                // 如果有watcher dep就会保存watcher 同时watcher也会保存dep\n                dep.depend()\n            }\n            return value\n        },\n        set(newValue) {\n            if (newValue === value) return\n            // 如果赋值的新值也是一个对象  需要观测\n            observe(newValue)\n            value = newValue\n            // 通知渲染watcher去更新--派发更新\n            dep.notify();\n        }\n    })\n}\n\nexport function observe(value) {\n    if (\n        Object.prototype.toString.call(value) === '[object Object]' ||\n        Array.isArray(value)\n    ) {\n        return new Observe(value)\n    }\n}","import { observe } from './observe/index.js'\n\nexport function initState(vm) {\n    const opts = vm.$options\n    if (opts.props) {\n        initProps(opts.props)\n    }\n    if (opts.methods) {\n        initMethod(vm)\n    }\n    if (opts.data) {\n        initData(vm)\n    }\n    if (opts.computed) {\n        initComputed(vm);\n    }\n    if (opts.watch) {\n        initWatch(vm);\n    }\n}\n\nfunction initData(vm) {\n    let data = vm.$options.data;\n\n    // data是function\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data || {}\n\n    for (let key in data) {\n        // 代理data上的属性到vm上，这样就可以通过this.a的方式直接访问了\n        proxy(vm, '_data', key)\n    }\n    observe(data)\n}\n\nfunction proxy(object, sourceKey, key) {\n    Object.defineProperty(object, key, {\n        get() {\n            return object[sourceKey][key]\n        },\n        set(val) {\n            object[sourceKey][key] = val\n        }\n    })\n}","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; //匹配标签名 形如 abc-123\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //匹配特殊标签 形如 abc:234 前面的abc:可有可无\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 匹配标签开始 形如 <abc-123 捕获里面的标签名\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束  >\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾 如 </abc-123> 捕获里面的标签名\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性  形如 id=\"app\"\n\nlet root, currentParent\n\nlet stack = []\n\nconst ELEMENT_TYPE = 1\nconst TEXT_TYPE = 3\n\nfunction createASTElement(tagName, attrs) {\n    return {\n        tag: tagName,\n        type: ELEMENT_TYPE,\n        children: [],\n        attrs,\n        parent: null\n    }\n}\n\n// 对开始标签处理\nfunction handleStartTag({ tagName, attrs }) {\n    let element = createASTElement(tagName, attrs)\n    if (!root) {\n        root = element\n    }\n    currentParent = element\n    stack.push(element)\n}\n\n// 对结束标签进行处理\nfunction handleEndTag() {\n    // 比如 <div><span></span></div> 当遇到第一个结束标签</span>时 会匹配到栈顶<span>元素对应的ast 并取出来\n    let element = stack.pop()\n    // 当前父元素就是栈顶的上一个元素 在这里就类似div\n    currentParent = stack[stack.length - 1]\n    if (currentParent) {\n        element.parent = currentParent\n        currentParent.children.push(element)\n    }\n}\n\n// 对文本进行处理\nfunction handleChars(text) {\n    // 去掉空格\n    text = text.replace(/\\s/g, \"\");\n    if (text) {\n        currentParent.children.push({\n            type: TEXT_TYPE,\n            text,\n        });\n    }\n}\n\nexport function parse(html) {\n    while (html) {\n        let textEnd = html.indexOf('<')\n        // 如果<在第一个，那么肯定是一个标签\n        if (textEnd === 0) {\n            // 匹配是否是开始标签\n            const startTagMatch = parseStartTag()\n            if (startTagMatch) {\n                handleStartTag(startTagMatch);\n                continue;\n            }\n\n            // 匹配是否是结束标签\n            const endTagMatch = html.match(endTag)\n            if (endTagMatch) {\n                advance(endTagMatch[0].length)\n                handleEndTag(endTagMatch[1])\n                continue;\n            }\n        }\n\n        let text\n        if (textEnd >= 0) {\n            text = html.substring(0, textEnd)\n        }\n        if (text) {\n            advance(text.length)\n            handleChars(text)\n        }\n    }\n\n    function parseStartTag() {\n        const start = html.match(startTagOpen)\n\n        if (start) {\n            const match = {\n                tagName: start[1],\n                attrs: []\n            }\n\n            advance(start[0].length)\n\n            let end, attr;\n            while (\n                !(end = html.match(startTagClose)) &&\n                (attr = html.match(attribute))\n            ) {\n                advance(attr[0].length)\n                attr = {\n                    name: attr[1],\n                    value: attr[3] || attr[4] || attr[5], //这里是因为正则捕获支持双引号 单引号 和无引号的属性值\n                }\n                match.attrs.push(attr)\n            }\n\n            if (end) {\n                advance(1)\n                return match\n            }\n        }\n    }\n\n\n    function advance(n) {\n        html = html.substring(n);\n    }\n\n    return root\n}\n\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; //匹配花括号 {{  }} 捕获花括号里面的内容\n\nfunction gen(node) {\n    if (node.type === 1) {\n        return generate(node)\n    } else {\n        // 文本节点 \n        let text = node.text\n        // 不存在花括号变量表达式\n        if (!defaultTagRE.test(text)) {\n            return `_v(${JSON.stringify(text)})`\n        }\n        let lastIndex = (defaultTagRE.lastIndex = 0);\n        let tokens = [];\n        let match, index;\n\n        while ((match = defaultTagRE.exec(text))) {\n            // index代表匹配到的位置\n            index = match.index;\n            if (index > lastIndex) {\n                //   匹配到的{{位置  在tokens里面放入普通文本\n                tokens.push(JSON.stringify(text.slice(lastIndex, index)));\n            }\n            //   放入捕获到的变量内容\n            tokens.push(`_s(${match[1].trim()})`);\n            //   匹配指针后移\n            lastIndex = index + match[0].length;\n        }\n        // 如果匹配完了花括号  text里面还有剩余的普通文本 那么继续push\n        if (lastIndex < text.length) {\n            tokens.push(JSON.stringify(text.slice(lastIndex)));\n        }\n        // _v表示创建文本\n        return `_v(${tokens.join(\"+\")})`;\n    }\n}\n\nfunction genProps(attrs) {\n    let str = \"\"\n    for (let i = 0; i < attrs.length; i++) {\n        let attr = attrs[i]\n        // 对attrs属性里面的style做特殊处理\n        if (attr.name === 'style') {\n            let obj = {};\n            attr.value.split(\";\").forEach((item) => {\n                let [key, value] = item.split(\":\");\n                obj[key] = value;\n            });\n            attr.value = obj;\n        }\n        str += `${attr.name}:${JSON.stringify(attr.value)},`;\n    }\n    return `{${str.slice(0, -1)}}`;\n}\n\nfunction getChildren(el) {\n    const children = el.children\n    if (children) {\n        return `${children.map((c) => gen(c)).join(',')}`\n    }\n}\n\nexport function generate(el) {\n    let children = getChildren(el)\n    let code = `_c('${el.tag}',${el.attrs.length ? `${genProps(el.attrs)}` : \"undefined\"\n        }${children ? `,${children}` : ''})`;\n    return code\n}","import { parse } from \"./parse\";\nimport { generate } from \"./codegen\";\nexport function compileToFunctions(template) {\n    // 我们需要把html字符串变成render函数\n    // 1.把html代码转成ast语法树  ast用来描述代码本身形成树结构 不仅可以描述html 也能描述css以及js语法\n    // 很多库都运用到了ast 比如 webpack babel eslint等等\n    let ast = parse(template);\n    // 2.优化静态节点\n    // 这个有兴趣的可以去看源码  不影响核心功能就不实现了\n    //   if (options.optimize !== false) {\n    //     optimize(ast, options);\n    //   }\n\n    // 3.通过ast 重新生成代码\n    // 我们最后生成的代码需要和render函数一样\n    // 类似_c('div',{id:\"app\"},_c('div',undefined,_v(\"hello\"+_s(name)),_c('span',undefined,_v(\"world\"))))\n    // _c代表创建元素 _v代表创建文本 _s代表文Json.stringify--把对象解析成文本\n    let code = generate(ast);\n    //   使用with语法改变作用域为this  之后调用render函数可以使用call改变this 方便code里面的变量取值\n    let renderFn = new Function(`with(this){return ${code}}`);\n    return renderFn;\n}","export function patch(oldVnode, vnode) {\n    const isRealElement = oldVnode.nodeType\n    if (isRealElement) {\n        const oldElm = oldVnode\n        const parentElm = oldElm.parentNode;\n        let el = createElm(vnode)\n        parentElm.insertBefore(el, oldElm.nextSibling)\n        parentElm.removeChild(oldVnode)\n        return el\n    }\n}\n\nfunction createElm(vnode) {\n    let { tag, data, key, children, text } = vnode\n    if (typeof tag === 'string') {\n        vnode.el = document.createElement(tag)\n        updateProperties(vnode);\n        children.forEach(child => {\n            return vnode.el.appendChild(createElm(child));\n        })\n    } else {\n        vnode.el = document.createTextNode(text);\n    }\n    return vnode.el\n}\n\nfunction updateProperties(vnode) {\n    let newProps = vnode.data || {}\n    let el = vnode.el\n    for (let key in newProps) {\n        if (key === 'style') {\n            for (let styleName in newProps.style) {\n                el.style[styleName] = newProps.style[styleName];\n            }\n        } else {\n            el.setAttribute(key, newProps[key]);\n        }\n    }\n}","import { pushTarget, popTarget } from \"./dep\"\nlet id = 0\n\nexport default class Watcher {\n    constructor(vm, exprOrFn, cb, options) {\n        this.vm = vm\n        this.exprOrFn = exprOrFn\n        this.cb = cb\n        this.options = options\n        this.id = id++\n        this.deps = []\n        this.depsId = new Set()\n        if (typeof exprOrFn === 'function') {\n            this.getter = exprOrFn\n        }\n        this.get()\n    }\n    get() {\n        // 在调用方法之前先把当前watcher实例推到全局Dep.target上\n        pushTarget(this)\n        //如果watcher是渲染watcher 那么就相当于执行  vm._update(vm._render()) 这个方法在render函数执行的时候会取值 从而实现依赖收集\n        this.getter()\n        // 在调用方法之后把当前watcher实例从全局Dep.target移除\n        popTarget()\n    }\n    addDep(dep) {\n        let id = dep.id\n        if (!this.depsId.has(id)) {\n            this.depsId.add(id)\n            this.deps.push(dep)\n            dep.addSub(this)\n        }\n    }\n    update() {\n        this.get()\n    }\n}","export default class Vnode {\n    constructor(tag, data, key, children, text) {\n        this.tag = tag;\n        this.data = data;\n        this.key = key;\n        this.children = children;\n        this.text = text;\n    }\n}\n\nexport function createElement(tag, data = {}, ...children) {\n    let key = data.key\n    return new Vnode(tag, data, key, children)\n}\n\nexport function createTextNode(text) {\n    return new Vnode(undefined, undefined, undefined, undefined, text)\n}","import { initMixin } from './init'\nimport { lifecycleMixin } from './lifecycle.js';\nimport { renderMixin } from './render';\n\nfunction Vue(options) {\n    this._init(options)\n}\n\ninitMixin(Vue)\n\nrenderMixin(Vue)\n\nlifecycleMixin(Vue)\n\nexport default Vue;","import { initState } from \"./state\";\nimport { compileToFunctions } from \"./compiler\";\nimport { mountComponent } from \"./lifecycle\";\nexport function initMixin(Vue) {\n    Vue.prototype._init = function (options) {\n        const vm = this;\n        vm.$options = options;\n        // 初始化状态\n        initState(vm);\n\n        // 如果有el属性 进行模板渲染\n        if (vm.$options.el) {\n            vm.$mount(vm.$options.el);\n        }\n    }\n\n    Vue.prototype.$mount = function (el) {\n        const vm = this\n        const options = vm.$options\n        el = document.querySelector(el)\n\n        if (!options.render) {\n            let template = options.template\n\n            if (!template && el) {\n                // 如果不存在render和template 但是存在el属性 直接将模板赋值到el所在的外层html结构（就是el本身 并不是父元素）\n                template = el.outerHTML;\n            }\n\n\n            // 最终需要把tempalte模板转化成render函数\n            if (template) {\n                const render = compileToFunctions(template);\n                options.render = render;\n            }\n        }\n\n        return mountComponent(vm, el)\n    }\n}","import { patch } from \"./vdom/patch\"\nimport Watcher from \"./observe/watcher\";\nexport function mountComponent(vm, el) {\n    vm.$el = el\n    // vm._update(vm._render());\n\n    let updateComponent = () => {\n        vm._update(vm._render());\n    }\n    new Watcher(vm, updateComponent, null, true)\n}\n\nexport function lifecycleMixin(Vue) {\n    Vue.prototype._update = function (vnode) {\n        const vm = this;\n        vm.$el = patch(vm.$el, vnode)\n    }\n}","import { createElement, createTextNode } from \"./vdom\";\n\nexport function renderMixin(Vue) {\n    Vue.prototype._render = function () {\n        const vm = this;\n        const { render } = vm.$options\n        const vnode = render.call(vm)\n        return vnode\n    }\n\n    Vue.prototype._c = function (...args) {\n        return createElement(...args)\n    }\n\n    Vue.prototype._v = function (text) {\n        return createTextNode(text)\n    }\n\n    Vue.prototype._s = function (val) {\n        return val === null\n            ? \"\"\n            : typeof val === 'object'\n                ? JSON.stringify(val)\n                : val\n    }\n}"],"names":["arrayProto","Array","prototype","arrayMethods","Object","create","forEach","method","args","result","call","this","ob","__ob__","inserted","slice","observeArray","id","Dep","constructor","subs","depend","target","addDep","notify","watcher","update","addSub","push","targetStack","Observe","value","defineProperty","enumerable","writable","configurable","isArray","__proto__","walk","data","keys","key","observe","dep","get","set","newValue","defineReactive","items","i","length","toString","initState","vm","opts","$options","props","initProps","methods","initMethod","_data","proxy","initData","computed","initComputed","watch","initWatch","object","sourceKey","val","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","attribute","root","currentParent","stack","ELEMENT_TYPE","TEXT_TYPE","handleStartTag","tagName","attrs","element","tag","type","children","parent","createASTElement","handleEndTag","pop","handleChars","text","replace","defaultTagRE","getChildren","el","map","c","node","generate","test","JSON","stringify","match","index","lastIndex","tokens","exec","trim","join","gen","str","attr","name","obj","split","item","genProps","compileToFunctions","template","code","html","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","advance","substring","start","end","n","parse","Function","patch","oldVnode","vnode","nodeType","oldElm","parentElm","parentNode","createElm","insertBefore","nextSibling","removeChild","document","createElement","newProps","styleName","style","setAttribute","updateProperties","child","appendChild","createTextNode","Watcher","exprOrFn","cb","options","deps","depsId","Set","getter","has","add","Vnode","Vue","_init","$mount","querySelector","render","outerHTML","$el","updateComponent","_update","_render","mountComponent","initMixin","_c","_v","undefined","_s","renderMixin","lifecycleMixin"],"mappings":"gCACA,MAAMA,EAAaC,MAAMC,UAGZC,EAAeC,OAAOC,OAAOL,GACrB,CACjB,OACA,MACA,QACA,UACA,SACA,UACA,QAGWM,SAASC,IACpBJ,EAAaI,GAAU,YAAaC,GAEhC,MAAMC,EAAST,EAAWO,GAAQG,KAAKC,KAAMH,GASvCI,EAAKD,KAAKE,OAIhB,IAAIC,EACJ,OAAQP,GACJ,IAAK,OACL,IAAK,UACDO,EAAWN,EACX,MACJ,IAAK,SACDM,EAAWN,EAAKO,MAAM,GAO9B,OAFID,GAAUF,EAAGI,aAAaF,GAEvBL,EACV,IC9CL,IAAIQ,EAAK,EACM,MAAMC,EACjBC,WAAAA,GACIR,KAAKM,GAAKA,IACVN,KAAKS,KAAO,EAChB,CACAC,MAAAA,GACQH,EAAII,QACJJ,EAAII,OAAOC,OAAOZ,KAE1B,CACAa,MAAAA,GACIb,KAAKS,KAAKd,SAASmB,GAAYA,EAAQC,UAC3C,CACAC,MAAAA,CAAOF,GACHd,KAAKS,KAAKQ,KAAKH,EACnB,EAGJP,EAAII,OAAS,KACb,MAAMO,EAAc,GClBpB,MAAMC,EACFX,WAAAA,CAAYY,GAER3B,OAAO4B,eAAeD,EAAO,SAAU,CAEnCA,MAAOpB,KAEPsB,YAAY,EACZC,UAAU,EACVC,cAAc,IAEdlC,MAAMmC,QAAQL,IACdA,EAAMM,UAAYlC,EAClBQ,KAAKK,aAAae,IAElBpB,KAAK2B,KAAKP,EAElB,CAEAO,IAAAA,CAAKC,GACDnC,OAAOoC,KAAKD,GAAMjC,SAAQmC,IACtB,IAAIV,EAAQQ,EAAKE,IAa7B,SAAwBF,EAAME,EAAKV,GAC/BW,EAAQX,GAER,IAAIY,EAAM,IAAIzB,EACdd,OAAO4B,eAAeO,EAAME,EAAK,CAC7BG,IAAGA,KAEK1B,EAAII,QAEJqB,EAAItB,SAEDU,GAEXc,GAAAA,CAAIC,GACIA,IAAaf,IAEjBW,EAAQI,GACRf,EAAQe,EAERH,EAAInB,SACR,GAER,CAlCYuB,CAAeR,EAAME,EAAKV,EAAM,GAExC,CAGAf,YAAAA,CAAagC,GACT,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAME,OAAQD,IAC9BP,EAAQM,EAAMC,GAEtB,EA2BG,SAASP,EAAQX,GACpB,GAC8C,oBAA1C3B,OAAOF,UAAUiD,SAASzC,KAAKqB,IAC/B9B,MAAMmC,QAAQL,GAEd,OAAO,IAAID,EAAQC,EAE3B,CCjEO,SAASqB,EAAUC,GACtB,MAAMC,EAAOD,EAAGE,SACZD,EAAKE,OACLC,UAAUH,EAAKE,OAEfF,EAAKI,SACLC,WAAWN,GAEXC,EAAKf,MAWb,SAAkBc,GACd,IAAId,EAAOc,EAAGE,SAAShB,KAGvBA,EAAOc,EAAGO,MAAwB,mBAATrB,EAAsBA,EAAK7B,KAAK2C,GAAMd,GAAQ,CAAA,EAEvE,IAAK,IAAIE,KAAOF,EAEZsB,EAAMR,EAAI,QAASZ,GAEvBC,EAAQH,EACZ,CArBQuB,CAAST,GAETC,EAAKS,UACLC,aAAaX,GAEbC,EAAKW,OACLC,UAAUb,EAElB,CAeA,SAASQ,EAAMM,EAAQC,EAAW3B,GAC9BrC,OAAO4B,eAAemC,EAAQ1B,EAAK,CAC/BG,IAAGA,IACQuB,EAAOC,GAAW3B,GAE7BI,GAAAA,CAAIwB,GACAF,EAAOC,GAAW3B,GAAO4B,CAC7B,GAER,CC3CA,MAAMC,EAAU,+BACVC,EAAgB,OAAMD,SAAcA,KACpCE,EAAe,IAAIC,OAAQ,KAAIF,KAC/BG,EAAgB,aAChBC,EAAS,IAAIF,OAAQ,QAAOF,WAC5BK,EAAY,4EAElB,IAAIC,EAAMC,EAENC,EAAQ,GAEZ,MAAMC,EAAe,EACfC,EAAY,EAalB,SAASC,GAAeC,QAAEA,EAAOC,MAAEA,IAC/B,IAAIC,EAZR,SAA0BF,EAASC,GAC/B,MAAO,CACHE,IAAKH,EACLI,KAAMP,EACNQ,SAAU,GACVJ,QACAK,OAAQ,KAEhB,CAIkBC,CAAiBP,EAASC,GACnCP,IACDA,EAAOQ,GAEXP,EAAgBO,EAChBN,EAAMnD,KAAKyD,EACf,CAGA,SAASM,IAEL,IAAIN,EAAUN,EAAMa,MAEpBd,EAAgBC,EAAMA,EAAM7B,OAAS,GACjC4B,IACAO,EAAQI,OAASX,EACjBA,EAAcU,SAAS5D,KAAKyD,GAEpC,CAGA,SAASQ,EAAYC,IAEjBA,EAAOA,EAAKC,QAAQ,MAAO,MAEvBjB,EAAcU,SAAS5D,KAAK,CACxB2D,KAAMN,EACNa,QAGZ,CCxDA,MAAME,EAAe,2BAuDrB,SAASC,EAAYC,GACjB,MAAMV,EAAWU,EAAGV,SACpB,GAAIA,EACA,MAAQ,GAAEA,EAASW,KAAKC,GAxDhC,SAAaC,GACT,GAAkB,IAAdA,EAAKd,KACL,OAAOe,EAASD,GACb,CAEH,IAAIP,EAAOO,EAAKP,KAEhB,IAAKE,EAAaO,KAAKT,GACnB,MAAQ,MAAKU,KAAKC,UAAUX,MAEhC,IAEIY,EAAOC,EAFPC,EAAaZ,EAAaY,UAAY,EACtCC,EAAS,GAGb,KAAQH,EAAQV,EAAac,KAAKhB,IAE9Ba,EAAQD,EAAMC,MACVA,EAAQC,GAERC,EAAOjF,KAAK4E,KAAKC,UAAUX,EAAK/E,MAAM6F,EAAWD,KAGrDE,EAAOjF,KAAM,MAAK8E,EAAM,GAAGK,WAE3BH,EAAYD,EAAQD,EAAM,GAAGxD,OAOjC,OAJI0D,EAAYd,EAAK5C,QACjB2D,EAAOjF,KAAK4E,KAAKC,UAAUX,EAAK/E,MAAM6F,KAGlC,MAAKC,EAAOG,KAAK,OAC7B,CACJ,CAuBsCC,CAAIb,KAAIY,KAAK,MAEnD,CAEO,SAASV,EAASJ,GACrB,IAAIV,EAAWS,EAAYC,GAG3B,MAFY,OAAMA,EAAGZ,QAAQY,EAAGd,MAAMlC,OAAU,GA3BpD,SAAkBkC,GACd,IAAI8B,EAAM,GACV,IAAK,IAAIjE,EAAI,EAAGA,EAAImC,EAAMlC,OAAQD,IAAK,CACnC,IAAIkE,EAAO/B,EAAMnC,GAEjB,GAAkB,UAAdkE,EAAKC,KAAkB,CACvB,IAAIC,EAAM,CAAA,EACVF,EAAKpF,MAAMuF,MAAM,KAAKhH,SAASiH,IAC3B,IAAK9E,EAAKV,GAASwF,EAAKD,MAAM,KAC9BD,EAAI5E,GAAOV,CAAK,IAEpBoF,EAAKpF,MAAQsF,CACjB,CACAH,GAAQ,GAAEC,EAAKC,QAAQZ,KAAKC,UAAUU,EAAKpF,SAC/C,CACA,MAAQ,IAAGmF,EAAInG,MAAM,GAAI,KAC7B,CAWsDyG,CAAStB,EAAGd,SAAW,cAClEI,EAAY,IAAGA,IAAa,KAEvC,CCjEO,SAASiC,EAAmBC,GAI/B,IAWIC,EAAOrB,EFyCR,SAAesB,GAClB,KAAOA,GAAM,CACT,IAmBI9B,EAnBA+B,EAAUD,EAAKE,QAAQ,KAE3B,GAAgB,IAAZD,EAAe,CAEf,MAAME,EAAgBC,IACtB,GAAID,EAAe,CACf7C,EAAe6C,GACf,QACJ,CAGA,MAAME,EAAcL,EAAKlB,MAAM/B,GAC/B,GAAIsD,EAAa,CACbC,EAAQD,EAAY,GAAG/E,QACvByC,EAAasC,EAAY,IACzB,QACJ,CACJ,CAGIJ,GAAW,IACX/B,EAAO8B,EAAKO,UAAU,EAAGN,IAEzB/B,IACAoC,EAAQpC,EAAK5C,QACb2C,EAAYC,GAEpB,CAEA,SAASkC,IACL,MAAMI,EAAQR,EAAKlB,MAAMlC,GAEzB,GAAI4D,EAAO,CACP,MAAM1B,EAAQ,CACVvB,QAASiD,EAAM,GACfhD,MAAO,IAKX,IAAIiD,EAAKlB,EACT,IAHAe,EAAQE,EAAM,GAAGlF,UAIXmF,EAAMT,EAAKlB,MAAMhC,MAClByC,EAAOS,EAAKlB,MAAM9B,KAEnBsD,EAAQf,EAAK,GAAGjE,QAChBiE,EAAO,CACHC,KAAMD,EAAK,GACXpF,MAAOoF,EAAK,IAAMA,EAAK,IAAMA,EAAK,IAEtCT,EAAMtB,MAAMxD,KAAKuF,GAGrB,GAAIkB,EAEA,OADAH,EAAQ,GACDxB,CAEf,CACJ,CAGA,SAASwB,EAAQI,GACbV,EAAOA,EAAKO,UAAUG,EAC1B,CAEA,OAAOzD,CACX,CExHc0D,CAAMb,IAchB,OADe,IAAIc,SAAU,qBAAoBb,KAErD,CCrBO,SAASc,EAAMC,EAAUC,GAE5B,GADsBD,EAASE,SACZ,CACf,MAAMC,EAASH,EACTI,EAAYD,EAAOE,WACzB,IAAI7C,EAAK8C,EAAUL,GAGnB,OAFAG,EAAUG,aAAa/C,EAAI2C,EAAOK,aAClCJ,EAAUK,YAAYT,GACfxC,CACX,CACJ,CAEA,SAAS8C,EAAUL,GACf,IAAIrD,IAAEA,EAAG/C,KAAEA,EAAIE,IAAEA,EAAG+C,SAAEA,EAAQM,KAAEA,GAAS6C,EAUzC,MATmB,iBAARrD,GACPqD,EAAMzC,GAAKkD,SAASC,cAAc/D,GAW1C,SAA0BqD,GACtB,IAAIW,EAAWX,EAAMpG,MAAQ,GACzB2D,EAAKyC,EAAMzC,GACf,IAAK,IAAIzD,KAAO6G,EACZ,GAAY,UAAR7G,EACA,IAAK,IAAI8G,KAAaD,EAASE,MAC3BtD,EAAGsD,MAAMD,GAAaD,EAASE,MAAMD,QAGzCrD,EAAGuD,aAAahH,EAAK6G,EAAS7G,GAG1C,CAtBQiH,CAAiBf,GACjBnD,EAASlF,SAAQqJ,GACNhB,EAAMzC,GAAG0D,YAAYZ,EAAUW,OAG1ChB,EAAMzC,GAAKkD,SAASS,eAAe/D,GAEhC6C,EAAMzC,EACjB,CCvBA,IAAIjF,EAAK,EAEM,MAAM6I,EACjB3I,WAAAA,CAAYkC,EAAI0G,EAAUC,EAAIC,GAC1BtJ,KAAK0C,GAAKA,EACV1C,KAAKoJ,SAAWA,EAChBpJ,KAAKqJ,GAAKA,EACVrJ,KAAKsJ,QAAUA,EACftJ,KAAKM,GAAKA,IACVN,KAAKuJ,KAAO,GACZvJ,KAAKwJ,OAAS,IAAIC,IACM,mBAAbL,IACPpJ,KAAK0J,OAASN,GAElBpJ,KAAKiC,KACT,CACAA,GAAAA,GPKG,IAAoBnB,IOHRd,KPIfkB,EAAYD,KAAKH,GACjBP,EAAII,OAASG,EOHTd,KAAK0J,SPOTxI,EAAY+D,MACZ1E,EAAII,OAASO,EAAYA,EAAYqB,OAAS,EOL9C,CACA3B,MAAAA,CAAOoB,GACH,IAAI1B,EAAK0B,EAAI1B,GACRN,KAAKwJ,OAAOG,IAAIrJ,KACjBN,KAAKwJ,OAAOI,IAAItJ,GAChBN,KAAKuJ,KAAKtI,KAAKe,GACfA,EAAIhB,OAAOhB,MAEnB,CACAe,MAAAA,GACIf,KAAKiC,KACT,ECnCW,MAAM4H,EACjBrJ,WAAAA,CAAYmE,EAAK/C,EAAME,EAAK+C,EAAUM,GAClCnF,KAAK2E,IAAMA,EACX3E,KAAK4B,KAAOA,EACZ5B,KAAK8B,IAAMA,EACX9B,KAAK6E,SAAWA,EAChB7E,KAAKmF,KAAOA,CAChB,ECHJ,SAAS2E,EAAIR,GACTtJ,KAAK+J,MAAMT,EACf,QCHO,SAAmBQ,GACtBA,EAAIvK,UAAUwK,MAAQ,SAAUT,GAC5B,MAAM5G,EAAK1C,KACX0C,EAAGE,SAAW0G,EAEd7G,EAAUC,GAGNA,EAAGE,SAAS2C,IACZ7C,EAAGsH,OAAOtH,EAAGE,SAAS2C,KAI9BuE,EAAIvK,UAAUyK,OAAS,SAAUzE,GAC7B,MACM+D,EADKtJ,KACQ4C,SAGnB,GAFA2C,EAAKkD,SAASwB,cAAc1E,IAEvB+D,EAAQY,OAAQ,CACjB,IAAInD,EAAWuC,EAAQvC,SASvB,IAPKA,GAAYxB,IAEbwB,EAAWxB,EAAG4E,WAKdpD,EAAU,CACV,MAAMmD,EAASpD,EAAmBC,GAClCuC,EAAQY,OAASA,CACrB,CACJ,CAEA,OCnCD,SAAwBxH,EAAI6C,GAC/B7C,EAAG0H,IAAM7E,EAMT,IAAI4D,EAAQzG,GAHU2H,KAClB3H,EAAG4H,QAAQ5H,EAAG6H,UAAU,GAEK,MAAM,EAC3C,CD2BeC,CApBIxK,KAoBeuF,GAElC,CD/BAkF,CAAUX,GGNH,SAAqBA,GACxBA,EAAIvK,UAAUgL,QAAU,WACpB,MACML,OAAEA,GADGlK,KACW4C,SAEtB,OADcsH,EAAOnK,KAFVC,OAMf8J,EAAIvK,UAAUmL,GAAK,YAAa7K,GAC5B,OJDD,SAAuB8E,EAAK/C,EAAO,CAAE,KAAKiD,GAC7C,IAAI/C,EAAMF,EAAKE,IACf,OAAO,IAAI+H,EAAMlF,EAAK/C,EAAME,EAAK+C,EACrC,CIFe6D,IAAiB7I,IAG5BiK,EAAIvK,UAAUoL,GAAK,SAAUxF,GACzB,OJAD,SAAwBA,GAC3B,OAAO,IAAI0E,OAAMe,OAAWA,OAAWA,OAAWA,EAAWzF,EACjE,CIFe+D,CAAe/D,IAG1B2E,EAAIvK,UAAUsL,GAAK,SAAUnH,GACzB,OAAe,OAARA,EACD,GACe,iBAARA,EACHmC,KAAKC,UAAUpC,GACfA,EAElB,CHfAoH,CAAYhB,GEEL,SAAwBA,GAC3BA,EAAIvK,UAAU+K,QAAU,SAAUtC,GACnBhI,KACRoK,IAAMtC,EADE9H,KACOoK,IAAKpC,GAE/B,CFLA+C,CAAejB"}